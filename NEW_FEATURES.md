# 🎉 新功能说明

## 更新内容

### 1. ⚙️ 可配置的数据集路径

**功能说明：**
- 现在可以自由设置数据集的保存位置，不再局限于默认路径
- 配置会被持久化保存，重启系统后依然有效

**使用方法：**
1. 进入"1. 设置类别"标签页
2. 在"数据集保存路径"输入框中输入你想要的绝对路径
3. 点击"💾 更新路径"按钮
4. 系统会自动创建必要的目录结构

**示例路径：**
```
/Users/你的用户名/Documents/yolo_dataset
/Users/你的用户名/Desktop/my_project/dataset
```

---

### 2. 📁 文件夹批量导入图片

**功能说明：**
- 支持一次性导入整个文件夹的图片
- 自动识别文件夹中的所有图片文件（支持 jpg, jpeg, png, bmp, webp, tiff）
- 显示每张图片的标注状态（已标注/未标注）
- 自动跳转到第一张未标注的图片

**使用方法：**
1. 进入"2. 标注数据"标签页
2. 选择数据集类型（训练集或验证集）
3. 在"方式1: 选择图片文件夹"中输入文件夹的绝对路径
4. 点击"📁 加载文件夹"按钮
5. 系统会显示图片列表和总数

**示例路径：**
```
/Users/你的用户名/Downloads/dog_images
/Users/你的用户名/Pictures/training_data
```

---

### 3. 🔄 标注完成自动跳转下一张

**功能说明：**
- 保存标注后自动跳转到下一张未标注的图片
- 如果当前位置之后没有未标注图片，会从头开始查找
- 所有图片标注完成后会提示"恭喜！所有图片都已标注完成！"
- 大大提高标注效率，无需手动切换图片

**工作流程：**
1. 在图片上框选物体
2. 输入类别 ID
3. 点击"💾 保存标注"
4. 系统自动保存并跳转到下一张未标注图片
5. 继续标注下一张...

---

### 4. 🔍 图片导航控制

**功能说明：**
- 提供"上一张"和"下一张"按钮，方便手动切换图片
- 显示当前图片位置（例如：5/100）
- 实时显示当前图片的标注状态

**界面显示：**
```
⬅️ 上一张  |  下一张 ➡️
当前: 5 / 100  ✓ 已标注
```

---

## 使用建议

### 推荐工作流程：

1. **准备阶段**
   - 设置自定义数据集路径（可选）
   - 定义所有类别

2. **批量标注阶段**
   - 将所有待标注图片放在一个文件夹中
   - 使用"文件夹导入"功能加载所有图片
   - 系统会自动跳转到第一张未标注图片
   - 开始标注，保存后自动跳转

3. **训练阶段**
   - 确保训练集和验证集都有足够的标注数据
   - 建议比例：80% 训练集，20% 验证集
   - 每个类别至少 100 张标注图片

4. **测试阶段**
   - 使用训练好的模型测试效果
   - 如果效果不好，继续添加更多标注数据

---

## 技术细节

### API 端点

新增的 API 端点：

1. `GET /api/dataset-path` - 获取当前数据集路径
2. `POST /api/dataset-path` - 设置数据集路径
   ```json
   {"path": "/your/custom/path"}
   ```

3. `POST /api/folder-images` - 加载文件夹图片列表
   ```json
   {
     "folder_path": "/path/to/images",
     "dataset_type": "train"
   }
   ```

4. `POST /api/load-image` - 从本地文件系统加载图片
   ```json
   {"path": "/path/to/image.jpg"}
   ```

### 配置文件

数据集路径配置保存在：
```
yolo_workspace/dataset_config.json
```

配置格式：
```json
{
  "dataset_path": "/Users/你的用户名/custom_dataset"
}
```

---

## 兼容性说明

- ✅ 保持了所有原有功能
- ✅ 向后兼容：不设置自定义路径时使用默认路径
- ✅ 支持单文件上传（原有方式）和文件夹批量导入（新方式）
- ✅ 可以在两种导入方式之间自由切换

---

## 快速开始示例

### 场景：标注 100 张猫咪图片

1. **准备图片**
   ```bash
   # 将所有猫咪图片放在一个文件夹
   mkdir ~/Desktop/cat_images
   # 复制所有图片到该文件夹
   ```

2. **设置类别**
   - 打开 http://localhost:7865
   - 添加类别："cat"

3. **批量导入**
   - 进入"标注数据"标签页
   - 选择"训练集"
   - 输入路径：`/Users/你的用户名/Desktop/cat_images`
   - 点击"加载文件夹"

4. **开始标注**
   - 在第一张图片上框选猫咪
   - 输入类别 ID：0
   - 点击保存
   - 自动跳转到下一张
   - 重复此过程直到完成

5. **训练模型**
   - 标注完成后进入"开始训练"标签页
   - 选择参数并开始训练

---

## 注意事项

⚠️ **重要提示：**

1. 文件夹路径必须是绝对路径（完整路径）
2. 确保路径中没有中文或特殊字符（建议使用英文）
3. 标注数据会自动复制到数据集目录，原始图片不会被修改
4. 建议定期备份 `yolo_workspace` 文件夹

---

## 问题排查

### 加载文件夹失败
- 检查路径是否正确（使用绝对路径）
- 确认文件夹存在且有读取权限
- 检查文件夹中是否有支持的图片格式

### 图片无法显示
- 确认图片文件没有损坏
- 检查图片格式是否支持
- 尝试使用其他图片

### 自动跳转不工作
- 确保使用的是文件夹导入模式
- 检查是否所有图片都已标注完成

---

## 更新日期

2025-12-03

## 版本

v2.1 - 增强版
